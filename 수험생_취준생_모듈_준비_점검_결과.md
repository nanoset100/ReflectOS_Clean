# ìˆ˜í—˜ìƒ/ì·¨ì¤€ìƒ ëª¨ë“ˆ ì¶”ê°€ ì „ ì¤€ë¹„ ìƒí™© ì ê²€ ê²°ê³¼

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ê²°ê³¼

### âœ… 1. app.pyì—ì„œë§Œ st.set_page_config() 1íšŒ ì‹¤í–‰
**ê²°ê³¼:** **Yes**

**í™•ì¸ ë‚´ìš©:**
- `app.py` 11ë²ˆì§¸ ì¤„ì—ë§Œ `st.set_page_config()` ì¡´ì¬
- `pages/` í´ë” ë‚´ ëª¨ë“  íŒŒì¼ì—ì„œ ì œê±° í™•ì¸ë¨
- ë¬¸ì„œ íŒŒì¼(`ì•ˆì •í™”_ì‘ì—…_ì™„ë£Œë³´ê³ .md`)ì—ë§Œ ì–¸ê¸‰ë˜ì–´ ìˆìŒ (ì‹¤ì œ ì½”ë“œ ì•„ë‹˜)

**ì½”ë“œ ìœ„ì¹˜:**
```11:16:app.py
st.set_page_config(
    page_title="ReflectOS",
    page_icon="ğŸª",
    layout="wide",
    initial_sidebar_state="expanded"
)
```

---

### âœ… 2. ë¡œê·¸ì¸ ê²Œì´íŠ¸ê°€ app.pyì— ìˆê³ , ë¡œê·¸ì¸ ì „ì—ëŠ” auth UIë§Œ ë³´ì„
**ê²°ê³¼:** **Yes**

**í™•ì¸ ë‚´ìš©:**
- `app.py` 18-22ë²ˆì§¸ ì¤„ì— ì¸ì¦ ê²Œì´íŠ¸ êµ¬í˜„
- `is_authenticated()` ì²´í¬ í›„ `render_auth_page()` í˜¸ì¶œ
- `st.stop()`ìœ¼ë¡œ ë¡œê·¸ì¸ ì „ì—ëŠ” ë” ì´ìƒ ì§„í–‰ ì•ˆ ë¨

**ì½”ë“œ ìœ„ì¹˜:**
```18:22:app.py
# === ì¸ì¦ ê²Œì´íŠ¸ ===
if not is_authenticated():
    # ë¡œê·¸ì¸ ì•ˆ ë¨ â†’ ì¸ì¦ UI ë Œë”ë§
    render_auth_page()
    st.stop()
```

---

### âš ï¸ 3. module_entries í…Œì´ë¸” + RLS(ë³¸ì¸ë§Œ ì ‘ê·¼) ì •ìƒ
**ê²°ê³¼:** **Yes (SQL íŒŒì¼ ê¸°ì¤€, DB ì ìš© í™•ì¸ í•„ìš”)**

**í™•ì¸ ë‚´ìš©:**
- `sql/module_entries.sql`ì— í…Œì´ë¸” ìƒì„± SQL ì¡´ì¬
- RLS ì •ì±… 4ê°œ ëª¨ë‘ `auth.uid()::text = user_id` ì¡°ê±´ìœ¼ë¡œ ë³¸ì¸ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- anon ì „ì²´ í—ˆìš© ì •ì±…ì€ ì œê±°ë¨

**RLS ì •ì±… í™•ì¸:**
```68:72:sql/module_entries.sql
-- SELECT ì •ì±…: ë³¸ì¸ í–‰ë§Œ ì¡°íšŒ ê°€ëŠ¥
CREATE POLICY "select own rows"
ON public.module_entries FOR SELECT
TO authenticated
USING (auth.uid()::text = user_id);
```

**ì£¼ì˜ì‚¬í•­:**
- ì‹¤ì œ DBì— ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸ í•„ìš”
- Supabase SQL Editorì—ì„œ `sql/module_entries.sql` ì‹¤í–‰ í•„ìš”
- ì‹¤í–‰ í›„ `sql/reload_pgrst_schema.sql` ì‹¤í–‰ í•„ìš”

---

### âœ… 4. lib/supabase_db.pyì— create_module_entry() / get_module_entries() ë“± ê³µìš© CRUD ì¡´ì¬
**ê²°ê³¼:** **Yes**

**í™•ì¸ ë‚´ìš©:**
- `create_module_entry()` í•¨ìˆ˜ ì¡´ì¬ (583-636ë²ˆì§¸ ì¤„)
- `get_module_entries()` í•¨ìˆ˜ ì¡´ì¬ (639-693ë²ˆì§¸ ì¤„)
- user_id ê²€ì¦ ë¡œì§ í¬í•¨ (ì´ë©”ì¼ ê¸ˆì§€)
- PGRST205 ì˜¤ë¥˜ ì²˜ë¦¬ í¬í•¨

**í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜:**
```583:591:lib/supabase_db.py
def create_module_entry(
    user_id: str,
    module: str,
    entry_type: str,
    occurred_on: date,
    payload: Dict,
    tags: List[str] = None,
    metadata: Dict = None
) -> Optional[Dict]:
```

```639:645:lib/supabase_db.py
def get_module_entries(
    user_id: str,
    module: str = None,
    entry_type: str = None,
    limit: int = 10,
    date_range: Tuple[date, date] = None
) -> List[Dict]:
```

---

### âœ… 5. pages/Settingsì—ì„œ ëª¨ë“ˆ ON/OFF ì €ì¥ â†’ rerun í›„ ë©”ë‰´ê°€ ë°”ë€œ
**ê²°ê³¼:** **Yes**

**í™•ì¸ ë‚´ìš©:**
- Settings í˜ì´ì§€ 266-295ë²ˆì§¸ ì¤„ì— ëª¨ë“ˆ í™œì„±í™” ì„¤ì • ì„¹ì…˜ ì¡´ì¬
- `set_active_modules()` í•¨ìˆ˜ í˜¸ì¶œ
- ì €ì¥ ì„±ê³µ ì‹œ `st.rerun()` ì‹¤í–‰
- `app.py`ì—ì„œ `get_active_modules()`ë¡œ í™œì„± ëª¨ë“ˆ ë¡œë“œ í›„ ì¡°ê±´ë¶€ë¡œ ë©”ë‰´ ì¶”ê°€

**ì½”ë“œ ìœ„ì¹˜:**
```266:295:pages/6_Settings.py
# === ëª¨ë“ˆ í™œì„±í™” ì„¤ì • ===
st.subheader("ğŸ”Œ ëª¨ë“ˆ í™œì„±í™”")

try:
    from lib.modules import MODULE_REGISTRY, get_active_modules, set_active_modules
    
    # í˜„ì¬ í™œì„± ëª¨ë“ˆ ë¡œë“œ
    current_active = get_active_modules(user_id)
    
    st.caption("ì‚¬ìš©í•  ëª¨ë“ˆì„ ì„ íƒí•˜ì„¸ìš”. ì„ íƒí•œ ëª¨ë“ˆì´ ë©”ë‰´ì— í‘œì‹œë©ë‹ˆë‹¤.")
    
    # ëª¨ë“ˆë³„ ì²´í¬ë°•ìŠ¤
    selected_modules = []
    for module_id, module_info in MODULE_REGISTRY.items():
        is_active = module_id in current_active
        checked = st.checkbox(
            f"{module_info['icon']} {module_info['name']}",
            value=is_active,
            help=module_info['description'],
            key=f"module_{module_id}"
        )
        if checked:
            selected_modules.append(module_id)
    
    # ì €ì¥ ë²„íŠ¼
    if st.button("ğŸ’¾ ëª¨ë“ˆ ì„¤ì • ì €ì¥", use_container_width=True, type="primary"):
        try:
            success = set_active_modules(user_id, selected_modules)
            if success:
                st.success("âœ… ëª¨ë“ˆ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!")
                st.info("í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë©”ë‰´ê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.")
                st.rerun()  # ë©”ë‰´ ì¦‰ì‹œ ê°±ì‹ 
```

**app.pyì—ì„œì˜ ë™ì  ë©”ë‰´ êµ¬ì„±:**
```41:47:app.py
# ëª¨ë“ˆ ê·¸ë£¹ (í™œì„±í™”ëœ ê²ƒë§Œ í‘œì‹œ)
if "health" in active_modules:
    health_info = MODULE_REGISTRY["health"]
    pages.append(st.Page("pages/health/today.py", title="ì˜¤ëŠ˜ ê¸°ë¡", icon="ğŸ“"))
    pages.append(st.Page("pages/health/weight.py", title="ì²´ì¤‘", icon="âš–ï¸"))
    pages.append(st.Page("pages/health/exercise.py", title="ìš´ë™", icon="ğŸ‹ï¸"))
    pages.append(st.Page("pages/health/report.py", title="ê±´ê°• ë¦¬í¬íŠ¸", icon="ğŸ“ˆ"))
```

---

### âš ï¸ 6. Homeì—ì„œ "ìµœê·¼ ëª¨ë“ˆ ê¸°ë¡ Nê°œ"ê°€ í‘œì‹œë˜ëŠ” ê³µí†µ ìš”ì•½ UIê°€ ìˆìŒ
**ê²°ê³¼:** **ë¶€ë¶„ì  Yes (health ëª¨ë“ˆë§Œ í•˜ë“œì½”ë”©, ê³µí†µí™” í•„ìš”)**

**í™•ì¸ ë‚´ìš©:**
- Home í˜ì´ì§€ 109-166ë²ˆì§¸ ì¤„ì— ëª¨ë“ˆ ê¸°ë¡ ì„¹ì…˜ ì¡´ì¬
- í˜„ì¬ëŠ” `health` ëª¨ë“ˆë§Œ í•˜ë“œì½”ë”©ë˜ì–´ ìˆìŒ
- ë‹¤ë¥¸ ëª¨ë“ˆ(student, jobseeker)ì„ ì¶”ê°€í•˜ë ¤ë©´ ê³µí†µí™” í•„ìš”

**í˜„ì¬ ì½”ë“œ:**
```116:166:pages/1_Home.py
if active_modules:
    st.divider()
    st.subheader("ğŸ“¦ ëª¨ë“ˆ ê¸°ë¡")
    
    # ê±´ê°• ëª¨ë“ˆ ìš”ì•½
    if "health" in active_modules:
        health_info = MODULE_REGISTRY["health"]
        st.markdown(f"### {health_info['icon']} {health_info['name']}")
        
        # ìµœê·¼ 3ê°œ ê¸°ë¡ ì¡°íšŒ
        recent_entries = get_module_entries(
            user_id=user_id,
            module="health",
            limit=3
        )
        
        if recent_entries:
            # ... health ëª¨ë“ˆ ì „ìš© ë Œë”ë§ ë¡œì§
```

**ê°œì„  í•„ìš”:**
- ëª¨ë“  í™œì„± ëª¨ë“ˆì— ëŒ€í•´ ë°˜ë³µë¬¸ìœ¼ë¡œ ì²˜ë¦¬í•˜ë„ë¡ ê³µí†µí™” í•„ìš”
- ê° ëª¨ë“ˆë³„ entry_typeì— ë”°ë¥¸ í‘œì‹œ ë¡œì§ì„ ëª¨ë“ˆë³„ë¡œ ë¶„ë¦¬ í•„ìš”

---

### âœ… 7. ê±´ê°• ëª¨ë“ˆì´ ìœ„ íë¦„ìœ¼ë¡œ ì •ìƒ ë™ì‘(ì´ë¯¸ ì„±ê³µ)
**ê²°ê³¼:** **Yes (ì‚¬ìš©ì í™•ì¸ ì™„ë£Œ)**

**í™•ì¸ ë‚´ìš©:**
- ê±´ê°• ëª¨ë“ˆì´ ìœ„ì˜ ëª¨ë“  íë¦„ì„ í†µê³¼í•˜ì—¬ ì •ìƒ ë™ì‘ ì¤‘
- Settingsì—ì„œ í™œì„±í™” â†’ ë©”ë‰´ í‘œì‹œ â†’ ê¸°ë¡ ì €ì¥ â†’ ì¡°íšŒ ëª¨ë‘ ì •ìƒ

---

## ğŸ“Š ì¢…í•© ê²°ê³¼

| í•­ëª© | ê²°ê³¼ | ë¹„ê³  |
|------|------|------|
| 1. st.set_page_config() 1íšŒë§Œ | âœ… Yes | ì™„ë²½ |
| 2. ë¡œê·¸ì¸ ê²Œì´íŠ¸ | âœ… Yes | ì™„ë²½ |
| 3. module_entries í…Œì´ë¸” + RLS | âš ï¸ Yes (DB ì ìš© í™•ì¸ í•„ìš”) | SQL íŒŒì¼ ì¤€ë¹„ë¨, ì‹¤ì œ DB ì ìš© í•„ìš” |
| 4. ê³µìš© CRUD í•¨ìˆ˜ | âœ… Yes | ì™„ë²½ |
| 5. ëª¨ë“ˆ ON/OFF ì €ì¥ â†’ ë©”ë‰´ ë³€ê²½ | âœ… Yes | ì™„ë²½ |
| 6. Home ê³µí†µ ìš”ì•½ UI | âš ï¸ ë¶€ë¶„ì  Yes | healthë§Œ í•˜ë“œì½”ë”©, ê³µí†µí™” í•„ìš” |
| 7. ê±´ê°• ëª¨ë“ˆ ì •ìƒ ë™ì‘ | âœ… Yes | í™•ì¸ ì™„ë£Œ |

---

## ğŸ”§ ìˆ˜í—˜ìƒ/ì·¨ì¤€ìƒ ëª¨ë“ˆ ì¶”ê°€ ì „ ê°œì„  ì‚¬í•­

### í•„ìˆ˜ ê°œì„  (6ë²ˆ í•­ëª©)

**ë¬¸ì œ:** Home í˜ì´ì§€ì˜ ëª¨ë“ˆ ìš”ì•½ì´ health ëª¨ë“ˆë§Œ í•˜ë“œì½”ë”©ë˜ì–´ ìˆìŒ

**í•´ê²° ë°©ë²•:**
- ëª¨ë“  í™œì„± ëª¨ë“ˆì— ëŒ€í•´ ë°˜ë³µë¬¸ìœ¼ë¡œ ì²˜ë¦¬
- ê° ëª¨ë“ˆë³„ entry_type í‘œì‹œ ë¡œì§ì„ ëª¨ë“ˆë³„ ì„¤ì •ìœ¼ë¡œ ë¶„ë¦¬

**ê¶Œì¥ êµ¬ì¡°:**
```python
# ëª¨ë“  í™œì„± ëª¨ë“ˆì— ëŒ€í•´ ë°˜ë³µ
for module_id in active_modules:
    module_info = MODULE_REGISTRY[module_id]
    recent_entries = get_module_entries(user_id=user_id, module=module_id, limit=3)
    # ëª¨ë“ˆë³„ ë Œë”ë§ (ê³µí†µ í•¨ìˆ˜ ë˜ëŠ” ëª¨ë“ˆë³„ ì„¤ì • ì‚¬ìš©)
```

---

## âœ… ìµœì¢… íŒì •

**ìˆ˜í—˜ìƒ/ì·¨ì¤€ìƒ ëª¨ë“ˆ ì¶”ê°€ ì¤€ë¹„ ìƒíƒœ:** **90% ì™„ë£Œ**

**ë‚¨ì€ ì‘ì—…:**
1. âš ï¸ Home í˜ì´ì§€ ëª¨ë“ˆ ìš”ì•½ ê³µí†µí™” (ì„ íƒì‚¬í•­ì´ì§€ë§Œ ê¶Œì¥)
2. âš ï¸ module_entries í…Œì´ë¸” DB ì ìš© í™•ì¸ (ì‹¤ì œ Supabaseì—ì„œ ì‹¤í–‰ í•„ìš”)

**ì¦‰ì‹œ ì§„í–‰ ê°€ëŠ¥ ì—¬ë¶€:** **Yes**
- í˜„ì¬ ìƒíƒœë¡œë„ ìˆ˜í—˜ìƒ/ì·¨ì¤€ìƒ ëª¨ë“ˆ ì¶”ê°€ ê°€ëŠ¥
- Home ê³µí†µí™”ëŠ” ë‚˜ì¤‘ì— ë¦¬íŒ©í† ë§ìœ¼ë¡œ ì²˜ë¦¬ ê°€ëŠ¥

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„ ê¶Œì¥ì‚¬í•­

1. **ì¦‰ì‹œ ì§„í–‰ ê°€ëŠ¥:** ìˆ˜í—˜ìƒ/ì·¨ì¤€ìƒ ëª¨ë“ˆ í˜ì´ì§€ ìƒì„±
2. **ì„ íƒì  ê°œì„ :** Home í˜ì´ì§€ ëª¨ë“ˆ ìš”ì•½ ê³µí†µí™”
3. **í™•ì¸ í•„ìš”:** Supabaseì—ì„œ module_entries í…Œì´ë¸” ì‹¤ì œ ì ìš© ì—¬ë¶€ í™•ì¸
